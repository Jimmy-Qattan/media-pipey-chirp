<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flappy Bird</title>
    <a-scene id="scene" physics="debug: true;">
      <a-light type="ambient" color="#fff" intensity="0.5"></a-light>
      <a-sky color="blue"></a-sky>

      <a-assets>
        <a-asset-item
          id="flappyBird"
          src="/flappy_bird/scene.gltf"
        ></a-asset-item>
        <a-asset-item id="pipe" src="/pipe/singlePipe.glb"></a-asset-item>
      </a-assets>
      <a-box
        static-body
        id="plane"
        position="0 -1 -5"
        color="red"
        width="100"
        depth="100"
        static-body
      ></a-box>
      <a-entity
        id="bird"
        position="0 50 -10"
        rotation="0 0 0"
        flappy-bird="jumptime: 100; falltime: 1500; fallangle: -1.3; jumpangle: 1.4; speed: 3"
      >
        <a-entity gltf-model="#flappyBird"></a-entity>
        <a-entity id="cameraRig" rotation="0 -90 0">
          <a-camera
            id="camera"
            wasd-controls-enabled="true"
            look-controls-enabled="true"
            position="7 3 5"
            rotation="-20 20 0"
            fov="100"
          ></a-camera>
        </a-entity>
      </a-entity>
    </a-scene>
    <style>
      #scene {
        width: 50%;
        height: 50%;
      }
      #video {
        position: fixed;
        top: 50%;
        width: 50%;
        height: 50%;
      }
      #calibrate {
        position: relative;
        top: 10%;
      }
    </style>
  </head>
  <body>
    <script src="script.js" type="module"></script>
    <button id="calibrate">Calibrate</button>
    <video
      id="video"
      autoplay
      playsinline
      style="transform: scaleX(-1)"
    ></video>
  </body>
  <script>
    bird.addEventListener("model-loaded", () => {
      //bird.setAttribute("dynamic-body", "");
    });
  </script>
</html>
